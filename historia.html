<!doctype html>
<html lang="es">
<head>
  <!-- =========================================================
       Moonveil Portal ‚Äî Biblioteca de Historias
       Tema: Editorial oscuro de lujo ¬∑ Tinta & Pergamino
       ========================================================= -->
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="color-scheme" content="dark"/>
  <title>Moonveil ¬∑ Biblioteca de Historias</title>

  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;900&family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600&family=Cinzel:wght@600;900&family=Press+Start+2P&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet"/>

  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64'%3E%3Crect width='100%25' height='100%25' fill='%230a0806'/%3E%3Crect x='8' y='8' width='48' height='48' fill='%23c9a227'/%3E%3Crect x='14' y='14' width='36' height='36' fill='%239a7b1e'/%3E%3C/svg%3E">

  <link rel="stylesheet" href="historia.css"/>
  <meta name="description" content="Moonveil Biblioteca ‚Äî Colecci√≥n de historias interactivas del reino."/>
</head>
<body>

  <!-- Fondo de pergamino/tinta -->
  <div class="bg-world" aria-hidden="true">
    <canvas id="bgCanvas"></canvas>
    <div class="bg-vignette"></div>
    <div class="bg-grain"></div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       HEADER / HUD (id√©ntico estructura)
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <header class="top-hud" role="banner">
    <nav class="navbar" aria-label="Navegaci√≥n principal">
      <a class="brand" href="inicio.html" aria-label="Ir a inicio">
        <span class="cube" aria-hidden="true"></span>
        <span class="brand__title">Moonveil <b>Stories</b></span>
      </a>
      <button class="nav-toggle" id="navToggle" aria-label="Abrir men√∫"><span></span></button>
      <ul class="nav-links" id="navLinks">
        <li><a href="inicio.html">Inicio</a></li>
        <li><a href="historia.html" class="active">Historias</a></li>
        <li><a href="index.html">Salir</a></li>
      </ul>
    </nav>
    <div class="hud-stats" aria-label="Indicadores">
      <div class="hud__bars">
        <div class="hud-bar hp" data-val="82" aria-label="Vida 82%"></div>
        <div class="hud-bar xp" data-val="63" aria-label="XP 63%"></div>
      </div>
      <div class="hud__inv" aria-label="Inventario r√°pido">
        <button class="slot" title="Esmeraldas"><span class="i i-emerald" aria-hidden="true"></span></button>
        <button class="slot" title="Pan"><span class="i i-bread" aria-hidden="true"></span></button>
        <button class="slot" title="Espada"><span class="i i-sword" aria-hidden="true"></span></button>
      </div>
    </div>
  </header>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       MAIN CONTENT
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <main class="lib-main">

    <!-- HERO de la biblioteca -->
    <section class="lib-hero">
      <div class="hero-ornament left" aria-hidden="true">
        <span class="orn-line"></span><span class="orn-diamond">‚óÜ</span><span class="orn-line"></span>
      </div>
      <div class="hero-center">
        <div class="hero-eyebrow reveal">
          <span class="quill">‚ú¶</span>
          Biblioteca Digital del Reino
          <span class="quill">‚ú¶</span>
        </div>
        <h1 class="hero-title reveal">
          <span class="ht-deco">Biblioteca</span>
          <span class="ht-main">Moonveil</span>
        </h1>
        <p class="hero-sub reveal">Descubre un universo de historias donde cada p√°gina es una nueva aventura esperando ser desbloqueada. Cr√≥nicas, leyendas y misterios del reino.</p>

        <!-- Stats del hero -->
        <div class="hero-stats reveal">
          <div class="hstat-item">
            <span class="hstat-num" id="st-total">0</span>
            <span class="hstat-lbl">Historias</span>
          </div>
          <div class="hstat-sep">‚óÜ</div>
          <div class="hstat-item">
            <span class="hstat-num" id="st-unlocked">0</span>
            <span class="hstat-lbl">Desbloqueadas</span>
          </div>
          <div class="hstat-sep">‚óÜ</div>
          <div class="hstat-item">
            <span class="hstat-num" id="st-locked">0</span>
            <span class="hstat-lbl">Bloqueadas</span>
          </div>
          <div class="hstat-sep">‚óÜ</div>
          <div class="hstat-item">
            <span class="hstat-num" id="st-pages">0</span>
            <span class="hstat-lbl">P√°ginas totales</span>
          </div>
        </div>

        <!-- Barra progreso -->
        <div class="progress-shelf reveal">
          <div class="progress-track">
            <div class="progress-fill" id="progressFill"></div>
            <div class="progress-glow"></div>
          </div>
          <span class="progress-label" id="progressLabel">0% completado</span>
        </div>

        <!-- Controles de audio -->
        <div class="audio-dock reveal" id="audioDock">
          <button class="audio-btn" id="playBtn" title="Play/Pause">‚ñ∂</button>
          <div class="audio-waveform" id="audioWave">
            <span></span><span></span><span></span><span></span><span></span>
            <span></span><span></span><span></span>
          </div>
          <button class="audio-btn" id="muteBtn" title="Silenciar">üîä</button>
          <span class="audio-title" id="audioTitle">Sin m√∫sica</span>
        </div>
      </div>
      <div class="hero-ornament right" aria-hidden="true">
        <span class="orn-line"></span><span class="orn-diamond">‚óÜ</span><span class="orn-line"></span>
      </div>
    </section>

    <!-- BARRA DE FILTROS -->
    <section class="lib-filters reveal">
      <div class="filters-inner">

        <!-- B√∫squeda -->
        <div class="search-wrap">
          <svg class="search-ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
          <input id="searchInput" type="search" placeholder="Buscar en la biblioteca‚Ä¶" autocomplete="off"/>
        </div>

        <!-- Chips categor√≠a -->
        <div class="filter-block">
          <span class="filter-label">üìÇ Categor√≠a</span>
          <div class="chip-row" id="catChips"></div>
        </div>

        <!-- Chips rareza -->
        <div class="filter-block">
          <span class="filter-label">‚ú® Rareza</span>
          <div class="chip-row" id="rarChips">
            <button class="fchip fchip-all active" data-rar="all">Todas</button>
            <button class="fchip fchip-common"  data-rar="common">Com√∫n</button>
            <button class="fchip fchip-rare"    data-rar="rare">Rara</button>
            <button class="fchip fchip-special" data-rar="special">Especial</button>
            <button class="fchip fchip-epic"    data-rar="epic">√âpica</button>
            <button class="fchip fchip-mythic"  data-rar="mythic">M√≠tica</button>
            <button class="fchip fchip-legend"  data-rar="legend">Legendaria</button>
            <button class="fchip fchip-dex"     data-rar="dex">DEX</button>
          </div>
        </div>

        <!-- Ordenar -->
        <div class="filter-block filter-block-right">
          <span class="filter-label">‚öôÔ∏è Orden</span>
          <select id="sortSelect" class="sort-select">
            <option value="default">Por defecto</option>
            <option value="title-az">T√≠tulo A‚ÄìZ</option>
            <option value="title-za">T√≠tulo Z‚ÄìA</option>
            <option value="pages-desc">M√°s p√°ginas</option>
            <option value="rarity">Por rareza</option>
            <option value="unlocked">Desbloqueadas primero</option>
          </select>
        </div>

      </div>
    </section>

    <!-- CONTADOR DE RESULTADOS -->
    <div class="results-bar" id="resultsBar">
      <span id="resultsCount">0 historias</span>
      <div class="results-line"></div>
    </div>

    <!-- GRID DE HISTORIAS -->
    <section class="lib-grid-wrap">
      <div id="storiesGrid" class="lib-grid"></div>
    </section>

    <!-- PAGINACI√ìN -->
    <div id="pagination" class="lib-pagination"></div>

  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="footer-inner container">
      <div class="foot-brand">
        <span class="cube"></span>
        <strong>Moonveil</strong> Portal ‚Äî Biblioteca
      </div>
      <nav class="foot-links">
        <a href="inicio.html">Inicio</a>
        <a href="#">Soporte</a>
        <a href="#">T√©rminos</a>
        <a href="#">Privacidad</a>
      </nav>
      <p class="foot-copy">¬© <span id="y"></span> Moonveil. Hecho con tinta y bloques.</p>
    </div>
  </footer>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       MODAL LECTOR DE LIBRO
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="storyModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="modal-overlay" id="storyOverlay"></div>
    <div class="modal-dialog modal-book">
      <header class="modal-head">
        <div class="modal-title-wrap">
          <span class="modal-rarity-tag" id="modalRarityTag">‚Äî</span>
          <h2 class="modal-ttl" id="modalTitle">‚Äî</h2>
          <p  class="modal-meta" id="modalMeta">‚Äî</p>
        </div>
        <button class="modal-close-x" id="closeStory" aria-label="Cerrar">‚úï</button>
      </header>
      <div class="book-stage">
        <!-- Libro f√≠sico -->
        <div class="book-wrap" id="bookWrap">
          <div class="book-left  page" id="leftPage"></div>
          <div class="book-spine"></div>
          <div class="book-right page" id="rightPage"></div>
        </div>
      </div>
      <footer class="modal-foot">
        <button class="page-nav-btn" id="prevBtn">‚Üê Anterior</button>
        <div class="page-indicator">
          <span id="curPage">1</span>
          <span class="sep">/</span>
          <span id="totPage">1</span>
        </div>
        <button class="page-nav-btn page-nav-primary" id="nextBtn">Siguiente ‚Üí</button>
      </footer>
    </div>
  </div>

  <!-- MODAL DESBLOQUEO -->
  <div id="unlockModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="modal-overlay" id="unlockOverlay"></div>
    <div class="modal-dialog modal-unlock">
      <div class="unlock-seal">
        <div class="seal-rings">
          <span class="seal-ring r1"></span>
          <span class="seal-ring r2"></span>
          <span class="seal-ring r3"></span>
        </div>
        <span class="seal-ico">üîê</span>
      </div>
      <h3 class="unlock-ttl">Historia Sellada</h3>
      <p class="unlock-story-name" id="unlockName"></p>
      <p class="unlock-hint">Introduce la contrase√±a para romper el sello</p>
      <div class="pass-wrap">
        <input type="password" id="passwordInput" placeholder="Contrase√±a‚Ä¶" autocomplete="off"/>
        <button class="pass-eye" id="eyeToggle" type="button">üëÅÔ∏è</button>
      </div>
      <div class="unlock-actions">
        <button class="btn-unseal" id="unlockBtn">üîì Romper el Sello</button>
        <button class="btn-cancel-unlock" id="cancelUnlock">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- MODAL INFO -->
  <div id="infoModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="modal-overlay" id="infoOverlay"></div>
    <div class="modal-dialog modal-info">
      <button class="modal-close-x modal-close-abs" id="closeInfo" aria-label="Cerrar">‚úï</button>
      <div class="info-cover" id="infoCoverImg">
        <div class="info-cover-overlay">
          <h3 id="infoTitle"></h3>
          <div class="info-cover-tags">
            <span id="infoRarityTag" class="itag">‚Äî</span>
            <span id="infoCategoryTag" class="itag">‚Äî</span>
          </div>
        </div>
      </div>
      <div class="info-body">
        <div class="info-stats-row">
          <div class="info-stat">
            <span class="ist-ico">üìñ</span>
            <div><div class="ist-lbl">P√°ginas</div><div class="ist-val" id="iPages">0</div></div>
          </div>
          <div class="info-stat">
            <span class="ist-ico">üéµ</span>
            <div><div class="ist-lbl">Audio</div><div class="ist-val" id="iAudio">No</div></div>
          </div>
          <div class="info-stat">
            <span class="ist-ico" id="iLockIco">üîí</span>
            <div><div class="ist-lbl">Estado</div><div class="ist-val" id="iStatus">Bloqueada</div></div>
          </div>
        </div>
        <div class="info-desc-block">
          <h4>Sinopsis</h4>
          <p id="iDesc"></p>
        </div>
        <button class="btn-read-info" id="readInfoBtn">üìñ Leer Historia</button>
      </div>
    </div>
  </div>

  <audio id="audioPlayer" loop></audio>
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script src="historia.js"></script>
</body>
</html>