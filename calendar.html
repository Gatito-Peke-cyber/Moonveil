<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <meta name="color-scheme" content="dark"/>
  <title>Moonveil â€” Calendario de Recompensas</title>
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64'%3E%3Crect width='100%25' height='100%25' fill='%23050710'/%3E%3Crect x='8' y='8' width='48' height='48' fill='%233b82f6'/%3E%3Crect x='14' y='14' width='36' height='36' fill='%231d4ed8'/%3E%3C/svg%3E">

  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;900&family=Cinzel:wght@400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="calendar.css"/>
</head>
<body>

  <!-- FONDO -->
  <div class="bg-world" aria-hidden="true">
    <canvas id="bgCanvas"></canvas>
    <div class="bg-grain"></div>
    <div class="bg-vignette"></div>
  </div>

  <!-- â•â• HEADER â•â• -->
  <header class="top-hud">
    <nav class="navbar">
      <a class="brand" href="inicio.html">
        <span class="cube"></span>
        <span class="brand__title">Moonveil <b>Portal</b></span>
      </a>
      <button class="nav-toggle" id="navToggle"><span></span></button>
      <ul class="nav-links" id="navLinks">
        <li><a href="inicio.html">Inicio</a></li>
        <li><a href="calendar.html" class="active">Calendario</a></li>
        <li><a href="index.html">Salir</a></li>
      </ul>
    </nav>
    <div class="hud-stats">
      <div class="hud__bars">
        <div class="hud-bar hp" data-val="88"></div>
        <div class="hud-bar xp" data-val="67"></div>
      </div>
      <div class="hud__inv">
        <button class="slot" title="Esmeraldas"><span class="i i-emerald"></span></button>
        <button class="slot" title="Pergamino"><span class="i i-scroll"></span></button>
        <button class="slot" id="keyInventoryBtn" title="Inventario de Llaves">
          <span class="i i-key"></span>
          <span class="key-notif" id="keyNotif" style="display:none">!</span>
        </button>
      </div>
    </div>
  </header>

  <!-- â•â• HERO â•â• -->
  <section class="cal-hero">
    <div class="hero-inner">
      <div class="hero-eyebrow reveal">âŸ¡ TEMPLO DEL TIEMPO âŸ¡</div>
      <h1 class="hero-title reveal">
        <span class="ht-small">CALENDARIO DE</span>
        <span class="ht-large">RECOMPENSAS</span>
      </h1>
      <p class="hero-sub reveal" id="todayLabel">Cargandoâ€¦</p>

      <div class="hero-stats reveal">
        <div class="hstat">
          <span class="hstat-ico">ğŸ”¥</span>
          <span class="hstat-n" id="stStreak">0</span>
          <span class="hstat-l">Racha</span>
        </div>
        <div class="hstat-div">âœ¦</div>
        <div class="hstat">
          <span class="hstat-ico">ğŸ</span>
          <span class="hstat-n" id="stClaimed">0</span>
          <span class="hstat-l">Reclamados</span>
        </div>
        <div class="hstat-div">âœ¦</div>
        <div class="hstat">
          <span class="hstat-ico">ğŸ—ï¸</span>
          <span class="hstat-n" id="stTotalKeys">0</span>
          <span class="hstat-l">Llaves</span>
        </div>
        <div class="hstat-div">âœ¦</div>
        <div class="hstat">
          <span class="hstat-ico">â­</span>
          <span class="hstat-n" id="stXP">0</span>
          <span class="hstat-l">XP Total</span>
        </div>
      </div>
    </div>
    <div class="hero-orn" aria-hidden="true">
      <span class="orn-l"></span><span class="orn-g">â—†</span><span class="orn-l"></span>
    </div>
  </section>

  <!-- â•â• BARRA XP â•â• -->
  <section class="xp-section reveal">
    <div class="cal-inner">
      <div class="xp-panel">
        <div class="xp-header">
          <div class="xp-left">
            <span class="xp-label">âœ¨ Barra de Experiencia Global</span>
            <span class="xp-sub" id="xpSubLabel">XP directo + por reclamar dÃ­as Â· Al llenar la barra ganas una llave Â· La Llave Futuro â© solo se consigue en cofres o recompensas de dÃ­a</span>
          </div>
          <div class="xp-right">
            <span class="xp-count" id="xpCount">0 / 500 XP</span>
            <span class="xp-key-hint">â†’ PrÃ³xima llave: <b id="nextKeyLabel">Normal ğŸ”µ</b></span>
          </div>
        </div>
        <div class="xp-track">
          <div class="xp-fill" id="xpFill" style="width:0%"></div>
          <div class="xp-glow"></div>
          <div class="xp-milestones" id="xpMilestones"></div>
        </div>
        <div class="xp-keys-earned" id="xpKeysEarned"></div>
      </div>
    </div>
  </section>

  <!-- â•â• LEYENDA â•â• -->
  <section class="xp-section" style="padding-bottom:8px">
    <div class="cal-inner">
      <div style="display:flex;flex-wrap:wrap;gap:10px;padding:10px 14px;background:rgba(8,10,24,.7);border:1px solid rgba(59,130,246,.1);border-radius:12px;font-size:.72rem;color:var(--muted)">
        <span>ğŸ“… DÃ­a normal</span>
        <span style="color:var(--cyn)">â© Reclamable con Llave Futuro (hasta 6 dÃ­as)</span>
        <span style="color:var(--sap3)">ğŸ—ï¸ Recompensa incluye llave directa</span>
        <span style="color:var(--amb)">ğŸ” Cofre bloqueado â€” abre con llave especÃ­fica</span>
        <span style="color:var(--grn)">âœ“ Reclamado</span>
        <span style="color:#f87171">âœ• DÃ­a perdido â€” recuperable con llave</span>
      </div>
    </div>
  </section>

  <!-- â•â• CONTROLES â•â• -->
  <section class="ctrl-section reveal">
    <div class="cal-inner ctrl-inner">
      <div class="month-nav">
        <button class="mnbtn" id="prevMonth">â€¹</button>
        <div class="month-display">
          <span class="month-name" id="monthName">â€”</span>
          <span class="month-badge" id="monthBadge"></span>
        </div>
        <button class="mnbtn" id="nextMonth">â€º</button>
      </div>
      <div class="ctrl-actions">
        <button class="calbtn calbtn-sec" id="btnPreview">ğŸ‘ Preview siguiente</button>
        <button class="calbtn calbtn-sec" id="btnHistory">ğŸ“œ Historial</button>
        <button class="calbtn calbtn-key" id="btnInventory">ğŸ—ï¸ Inventario <span class="key-badge" id="totalKeyBadge">0</span></button>
      </div>
    </div>
  </section>

  <!-- â•â• CALENDARIO â•â• -->
  <main class="cal-main">
    <div class="cal-inner">
      <div class="month-prog-bar reveal">
        <div class="mpb-info">
          <span id="mpbText">0 / 0 dÃ­as</span>
          <span id="mpbPct">0%</span>
        </div>
        <div class="mpb-track"><div class="mpb-fill" id="mpbFill" style="width:0%"></div></div>
      </div>

      <div class="weekdays" aria-hidden="true">
        <span>Lun</span><span>Mar</span><span>MiÃ©</span><span>Jue</span><span>Vie</span><span>SÃ¡b</span><span>Dom</span>
      </div>

      <div id="calGrid" class="cal-grid reveal" role="grid"></div>
    </div>
  </main>

  <!-- â•â• FOOTER â•â• -->
  <footer class="site-footer">
    <div class="cal-inner foot-inner">
      <div class="foot-brand"><span class="cube"></span><strong>Moonveil</strong> Portal</div>
      <p class="foot-copy">Â© <span id="yr"></span> Moonveil. Templo del Tiempo.</p>
    </div>
  </footer>

  <!-- â•â• MODAL: RECOMPENSA â•â• -->
  <div id="rewardModal" class="modal" aria-hidden="true">
    <div class="m-backdrop" id="mBd"></div>
    <div class="m-panel" id="mPanel">
      <button class="m-close" id="mClose">âœ•</button>
      <div id="mContent"></div>
    </div>
  </div>

  <!-- â•â• MODAL: USAR LLAVE / LLAVE FUTURO â•â• -->
  <div id="keyModal" class="modal" aria-hidden="true">
    <div class="m-backdrop" id="kmBd"></div>
    <div class="m-panel m-panel-sm" id="kmPanel">
      <button class="m-close" id="kmClose">âœ•</button>
      <div id="kmContent"></div>
    </div>
  </div>

  <!-- â•â• MODAL: INVENTARIO â•â• -->
  <div id="inventoryModal" class="modal" aria-hidden="true">
    <div class="m-backdrop" id="invBd"></div>
    <div class="m-panel" id="invPanel">
      <button class="m-close" id="invClose">âœ•</button>
      <div id="invContent"></div>
    </div>
  </div>

  <!-- â•â• MODAL: PREVIEW â•â• -->
  <div id="previewModal" class="modal" aria-hidden="true">
    <div class="m-backdrop" id="pvBd"></div>
    <div class="m-panel m-panel-wide" id="pvPanel">
      <button class="m-close" id="pvClose">âœ•</button>
      <div id="pvContent"></div>
    </div>
  </div>

  <!-- â•â• MODAL: HISTORIAL â•â• -->
  <div id="historyModal" class="modal" aria-hidden="true">
    <div class="m-backdrop" id="hmBd"></div>
    <div class="m-panel" id="hmPanel">
      <button class="m-close" id="hmClose">âœ•</button>
      <div id="hmContent"></div>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script src="calendar.js"></script>
</body>
</html>